# DjangoStudy
파이썬 웹 프로그래밍 프레임워크인 Django를 이용하기 

## 프로젝트와 애플리케이션 생성하기
### 프로젝트 생성
**django-admin startproject 프로젝트이름 경로**
+ 내가 설정한 프로젝트이름의 디렉토리와 manage.py가 생성된다.
### 애플리케이션 생성하기
**python manage.py startapp 애플리케이션이름**
+ 내가 설정한 애플리케이션이름의 디렉토리가 생성된다.
   
## 실행하기
**python manage.py runserver IP주소:포트번호**
+ 포트번호를 생략하면 **8000**번으로 자동 설정된다.
+ 로컬에서 실행하여 접속할 시 IP주소는 **127.0.0.1**이다 
  + Chrome브라우저에 **127.0.0.1:8000**으로 검색하면 django화면을 볼 수 있다.

## settings.py
### 프로젝트 설정 파일
secret key, debug mode, 개발환경에서 수행되는 내용을 다르게 만들고 할 때 등등의 설정을 할 수 있다
+ DEBUG
  + True : 개발 모드
  + False : 운영 모드
+ ALLOWED_HOSTS
  + 운영 모드인 경우 : 반드시 서버의 IP/도메인을 기재
  + 개발 모드인 경우 : 자동으로 localhost, 127.0.0.1로 간주
    + 모든 컴퓨터 : '*'
+ INSTAKKED_APPS
  + 사용할 패키지와 애플리케이션 기재
+ MIDDLEWARE
  + 요청이 오기 전/후에 수행할 내용을 기재
+ DATABASE
  + 기본으로 sqlite3로 설정되어 있다

## 관리자 계정
django는 데이터베이스 관리 기능을 편리하게 하기위해서 관리자 사이트를 별도로 제공한다
+ 웹브라우저에서 기본URL/admin으로 접속하면 로그인화면을 볼 수 있다
  + ex) http://127.0.0.1:8000/admin
처음에는 계정이 존재하지않으므로 데이터베이스 연결을 수행하면서 관리자 계정을 생성해야한다

### 데이터베이스 연결
장고 프로젝트를 처음 실행하기 전이나 데이터베이스에 변경 사항이 있는 경우 데이터베이스 설정을 다시 해달라고 요청을 할 수 있다
1. python manage.py migrations
2. python manage.py migrate

### 관리자 계정 생성
**python managy.py createsuperuser**
명령을 수행하고 이름, 이메일, 비밀번호를 입력하여 계정을 생성한다 

## 요청 URL과 처리 함수
+ 요청 URL : urls.py
+ 처리함수 : views.py
  + 간단한 내용을 HTML로 출력 : HttpResponse객체에 직접 내용 작성
  + 복잡한 내용(서버가 처리하고 전달받은 데이터)을 출력 : **template**
 
### template
규격에 맞게 작성하면 HTML로 변환하여 서버가 클라이언트에게 전송
+ 애플리케이션 디렉토리에 templates디렉토리 생성
  + views.py에서 함수의 리턴 값으로 render()함수 작성
 
#### render(request, HTML파일경로, [{'키':"값"}])
render()함수의 매개변수는 총 3개
1. 클라이언트의 요청
2. 클라이언트의 요청으로 부터 출력할 html파일의 경로
3. 템플릿에 전달되는 데이터(optional) - 키:값의 형태

##### html파일
body태그안에 {{ 키 }}와 같은 형식으로 작성하면 화면에 키에 해당하는 값이 그 자리에 출력된다
+ Django Template는 View로 부터 전달된 다양한 데이터들을 템플릿에 편리하게 넣을 수 있도록 여러 템플릿 태그들을 제공한다

## URL에 포함된 데이터 처리
예전에는 URL에 직접 데이터를 포함시키지 않고 querystring의 형태로 사용
+ 최근에는 URL에 데이터를 포함시키는 경우가 많다
+ **요청경로/<자료형:데이터이름>** 형식으로 요청 URL작성
+ 요청 처리 함수에서 **데이터 이름**을 **매개 변수**로 설정

## GET 메소드 - querystring
#### GET 메소드 : URL에 파라미터를 포함시켜 전송하는 방식
+ 바로 브라우저 테스트 가능
+ 보안성이 낮음
+ 데이터 길이에 제한이 있다
#### 요청 처리 함수에서 GET메소드의 값 읽기
+ **request.GET["데이터이름"]** 의 형식으로 값을 읽는다
+ 브라우저에서 테스트 시, 요청URL/?뒤에데이터이름=값&데이터이름=값..의 형태로 요청 전송

## POST 메소드
#### POST 메소드 : 데이터를 body에 숨겨서 전송하는 방식
+ 데이터를 삽입할 때 사용하는 메소드이다
  + 로그인은 데이터를 조회하는 작업이지만 비밀번호가 포함된 경우이므로 POST 메소드를 사용하여 처리
 
#### 브라우저 테스트가 어려우므로 postman web요청 도구를 사용
+ postman : 개발자들이 API를 디자인, 빌드, 테스트를 방복하기 위함 API 플랫폼
+ **POST 메소드로 데이터 읽는 방법**
  + **json.loads(request.body)** 로 읽기 : raw
  + **request.POST.get("데이터이름", 값)** 으로 읽기 : form-data
 
#### Forbidden Error - CSRF
Cross Site Request Forgery : 크로스 사이트 요청 위조
+ 인증된 사용자가 웹 애플리케이션에 특정 요청을 보내도록 유도하는 공격 행위
  + 사용자가 인증한 세션에서 웹 애플리케이션이 정상적인 요청과 비정상적인 요청을 구분하지 못하는 점을 악용
+ **CSRF 종료** 를 시키고 postman에서 다시 test를 수행한다 

## file upload - post
FileSystemStorage 클래스 이용 
+ 실제 운영 환경에서 파일은 로컬에 저장하지 않으므로 클라우드나 별도의 파일 서버를 만들어서 저장

### settings.py 설정
1. 정적 파일이 저장되는 디렉토리 설정
2. 로컬에 파일이 업로드할 때 설정
   + VScode에 media디렉토리 생성하고 그 안에 DjangoStudy디렉토리를 생성한다

## HTTP와 HTTPS의 특징
상태가 없다
즉, 클라이언트가 요청을 전송하면 서버가 응답을 하면 연결이 해제가 되므로 다음 요청을 보낼 때 이전 상태의 대한 정보가 없다.
+ 웹 서버는 클라이언트가 요청을 할 때 하나의 키를 발급해서 클라이언트에 저장하고 동시에 서버에도 저장하여 클라이언트가 요청을 할 때마다 키와 함께 전송하여 서버는 키 값으로 클라이언트를 구분하도록 하자!
  
### Cookie
클라이언트에 데이터를 저장하는 기술
+ 보안이 취약하므로 중요한 정보는 저장하지 말하야한다 
### Session
서버에 클라이언트 정보를 저장하는 기술
+ 서버의 메모리를 차지하므로 Session의 수가 늘어나면 서버 애플리케이션 처리 속도가 느려진다 

## MySQL 데이터베이스 연동
1. mysqlclient라는 패키지가 필요 : **pip install mysqlclient**
2. settings.py 수정

**애플리케이션 디렉토리 models.py**
1. 클래스 단위로 테이블을 정의한다
2. 클래스를 만들 때는 Model클래스로 부터 상속받아야 한다
3. primary key를 설정하지 않으면 테이블이 생성하면서 자동으로 id가 생성된다
4. 클래스안에 속성을 선언하면 테이블의 컬럼이 만들어지고 models의 여러 종류의 클래스와 옵션 설정이 가능하다
5. 대다수의 ORM은 테이블이 존재하지 않으면 테이블을 자동으로 생성해준다
  + 제약조건은 속성의 자료형에 해당하는 클래스에서 생성자나 메소드를 통해서 지정이 가능하다 

**데이터베이스 정보를 수정**한 경우 반영을 해주어야한다
1. python manage.py makemigrations
2. python manage.py migrate

  
### 클래스(테이블)생성 방법
방법1. models.py에 클래스를 정의하고 데이터베이스에 반영한다


방법2. 데이터베이스에 테이블을 생성하고 models.py에 매핑되는 클래스를 정의하여 반영한다

---
## CURD 작업
템플릿 엔진을 사용하여 정적파일을 사용
1. 데이터 조회
   + 브라우저에서 확인 가능


1.2 과정부터는 postman으로 test수행하고 결과확인


1.2 특정 데이터 조회


3. 데이터 삽입
   + form형태로 삽입
4. 데이터 수정
   + form형태로 삽입
5. 데이터 삭제
   + form형태로 삽입
   + 삭제를 수행하고 결과는 데이터베이스를 확인
  
